# ADR for Database   
### ADR (Architecture Decision Record): Выбор базы данных для проекта   
**Дата**: 2024-11-16
**Решение**: Использовать PostgreSQL в качестве основной базы данных   
 --- 
### Контекст   
Проект требует выбора системы управления базами данных (СУБД) для хранения и управления данными. Основные требования к базе данных:   
1. **Надёжность и соответствие ACID**: база данных должна обеспечивать целостность данных и устойчивость к сбоям.   
2. **Масштабируемость**: поддержка работы с большим объёмом данных и рост нагрузки.   
3. **Гибкость запросов**: необходимость работы со сложными реляционными структурами и выполнения сложных запросов.   
4. **Поддержка расширенных функций**: таких как работа с JSON, полнотекстовый поиск, хранимые процедуры и триггеры.   
5. **Сообщество и документация**: наличие активного сообщества, обширной документации и готовых решений.   
6. Опенсорсность инструмента: предпочтение системам с открытым исходным кодом для снижения зависимости от конкретного поставщика.   
   
Рассматриваемые варианты: **PostgreSQL**, **MySQL**, **MongoDB**, **SQLite**.   
 --- 
### Анализ альтернатив   
### 1. PostgreSQL   
### Надёжность и соответствие ACID   
PostgreSQL полностью соответствует ACID-требованиям и обеспечивает высокую надёжность данных благодаря транзакциям, механизмам журналирования и восстановления после сбоев.   
### Масштабируемость   
PostgreSQL поддерживает как вертикальное, так и горизонтальное масштабирование. Встроенная репликация и сторонние инструменты позволяют эффективно обрабатывать большие объёмы данных.   
### Гибкость запросов   
PostgreSQL предоставляет мощный SQL-движок с поддержкой сложных запросов: CTE (Common Table Expressions), оконные функции, подзапросы и функции агрегации.   
### Поддержка расширенных функций   
PostgreSQL поддерживает JSONB для работы с JSON-данными, хранимые процедуры, триггеры, пользовательские типы данных и расширения (например, PostGIS для геоданных).   
### Сообщество и документация   
PostgreSQL имеет активное сообщество и обширную документацию. Доступно множество расширений, инструментов и учебных материалов.   
### Опенсорсность инструмента   
PostgreSQL является полностью опенсорсным инструментом с лицензией PostgreSQL License, что позволяет свободно использовать и модифицировать систему.   
### 2. MySQL   
### Надёжность и соответствие ACID   
MySQL поддерживает ACID-транзакции при использовании движка InnoDB. Однако в некоторых сценариях могут возникать проблемы с надёжностью при высоких нагрузках.   
### Масштабируемость   
MySQL хорошо масштабируется вертикально и поддерживает репликацию для горизонтального масштабирования. Однако шардирование требует дополнительных инструментов и сложной настройки.   
### Гибкость запросов   
MySQL поддерживает стандарт SQL, но функциональность для сложных запросов, таких как оконные функции, появилась относительно недавно и не так развита, как в PostgreSQL.   
### Поддержка расширенных функций   
MySQL поддерживает базовые функции, такие как JSON, но в меньшей степени по сравнению с PostgreSQL. Поддержка расширений ограничена.   
### Сообщество и документация   
MySQL имеет большое сообщество и отличную документацию, но часть инструментов и решений может быть коммерчески ориентирована.   
### Опенсорсность инструмента   
MySQL является опенсорсным, но некоторые функции доступны только в коммерческой версии MySQL Enterprise, что ограничивает полную свободу использования.   
### 3. MongoDB   
### Надёжность и соответствие ACID   
MongoDB изначально не соответствовал ACID, но начиная с версии 4.0 поддерживает транзакции на уровне нескольких документов. Однако надёжность ниже, чем у реляционных СУБД.   
### Масштабируемость   
MongoDB разработан для горизонтального масштабирования и отлично подходит для распределённых систем благодаря встроенному шардированию и репликации.   
### Гибкость запросов   
MongoDB использует гибкий формат документов (JSON-like), что позволяет работать с неструктурированными данными. Однако сложные запросы менее выразительны по сравнению с SQL.   
### Поддержка расширенных функций   
MongoDB поддерживает функции агрегации, индексирования и работы с JSON, но отсутствует строгая поддержка SQL и расширений.   
### Сообщество и документация   
MongoDB имеет активное сообщество и хорошую документацию, особенно для разработчиков NoSQL-решений.   
### Опенсорсность инструмента   
MongoDB имеет опенсорсную версию с лицензией SSPL (Server Side Public License), что накладывает ограничения на использование в коммерческих облачных средах.   
### 4. SQLite   
### Надёжность и соответствие ACID   
SQLite поддерживает ACID-транзакции и является надёжной СУБД для локальных приложений. Однако для высоконагруженных систем его возможности ограничены.   
### Масштабируемость   
SQLite не подходит для горизонтального масштабирования и больших объёмов данных. Он рассчитан на небольшие локальные базы данных.   
### Гибкость запросов   
SQLite поддерживает стандарт SQL, но функциональность ограничена по сравнению с PostgreSQL и MySQL.   
### Поддержка расширенных функций   
SQLite не поддерживает расширенные функции, такие как хранимые процедуры или JSONB.   
### Сообщество и документация   
SQLite имеет хорошую документацию и активное сообщество, но его использование ограничено определёнными сценариями.   
### Опенсорсность инструмента   
SQLite является полностью опенсорсным с лицензией Public Domain, что делает его свободно доступным для любых целей.   
 --- 
### Решение   
После анализа было принято решение использовать **PostgreSQL** в качестве основной СУБД проекта.   
 --- 
### Обоснование выбора   
1. **Надёжность и соответствие ACID**:
PostgreSQL гарантирует высокую надёжность хранения данных и поддержку транзакций, что критически важно для нашего проекта.   
2. **Расширенные возможности**:
PostgreSQL предоставляет мощные инструменты для работы с реляционными структурами, JSON, полнотекстовым поиском и аналитическими запросами, что позволяет решать широкий круг задач без использования дополнительных инструментов.   
3. **Масштабируемость и отказоустойчивость**:
Поддержка репликации и кластеризации позволяет масштабировать PostgreSQL для работы в условиях роста нагрузки.   
4. **Открытый исходный код и активное сообщество**:
PostgreSQL активно развивается, и его использование исключает зависимость от коммерческих поставщиков.   
 --- 
   
### Последствия   
1. **Положительные**:   
    - Возможность использовать мощные инструменты для сложных запросов и анализа данных.   
    - Надёжное хранение данных и высокая производительность в долгосрочной перспективе.   
    - Широкий выбор готовых решений и расширений.   
2. **Негативные**:   
    - Потребуется больше ресурсов на настройку и управление PostgreSQL.   
    - Требуется опыт работы с PostgreSQL у команды или обучение сотрудников.   
 --- 
   
### Заключение   
Выбор PostgreSQL для разработки бэкенда обеспечивает баланс между функциональностью, производительностью и надёжностью. Эта СУБД соответствует текущим требованиям проекта и предоставляет возможности для дальнейшего масштабирования и поддержки новых функциональностей.   
   
