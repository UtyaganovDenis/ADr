# ADR for AI model   
**Дата**: 2024-11-15
**Решение**: Использовать подход на основе генеративных моделей (например, GAN) и дополнить его предобученными сегментационными и поза-ориентированными моделями.   
 --- 
### Контекст   
Проект предполагает разработку функционала виртуальной примерки одежды, который позволит пользователям загружать свои фотографии и видеть, как на них будет выглядеть выбранный предмет гардероба. Основная цель — предоставить реалистичный и удобный опыт примерки.   
 --- 
### Анализ кондидатов   
### 1. GAN (Generative Adversarial Networks)   
- **Плюсы**:   
    - Отлично справляются с генерацией реалистичных изображений.   
    - Есть готовые реализации для задач виртуальной примерки, такие как VITON и CP-VTON.   
- **Минусы**:   
    - Высокие требования к качеству данных для обучения.   
    - Ограничения в обработке крайних случаев (необычные позы, освещение).   
   
### 2. DensePose   
- **Плюсы**:   
    - Обеспечивает точное наложение одежды на модель тела.   
    - Хорошо работает для захвата позы и её переноса.   
- **Минусы**:   
    - Требует дополнительной обработки для наложения текстур.   
    - Не генерирует финальное изображение, только "каркас".   
   
### 3. Сегментационные модели (Mask R-CNN, U-Net)   
- **Плюсы**:   
    - Отлично работают для выделения контуров тела и областей одежды.   
    - Могут быть использованы для предварительной обработки данных.   
- **Минусы**:   
    - Не способны самостоятельно генерировать реалистичные изображения.   
   
### 4. Диффузионные модели (Stable Diffusion, ControlNet)   
- **Плюсы**:   
    - Генерация высококачественных изображений с возможностью адаптации к позе.   
    - Поддержка большого числа текстур и сложных сценариев.   
    - Подходят для реалистичной доработки деталей.   
- **Минусы**:   
    - Высокие вычислительные затраты.   
    - Требуют значительного количества данных и времени для обучения.   
 --- 
   
### Решение   
Для реализации функционала виртуальной примерки выбрана архитектура, основанная на сочетании **GAN** и моделей сегментации, таких как Mask R-CNN.
   
 --- 
### Обоснование выбора   
1. **Реализм генерации**:
GAN-дизайн доказал свою эффективность в генерации визуально правдоподобных изображений одежды на фотографиях.   
2. **Предобработка и адаптация одежды**:
Сегментационные модели обеспечивают точное выделение тела и предметов одежды, упрощая работу основного генеративного блока.   
3. **Расширяемость**:
Обучение моделей на новых типах одежды или изображениях можно реализовать за счёт модульного подхода, обновляя только необходимые компоненты.   
 --- 
   
### Последствия   
1. **Положительные**:   
    - Высокий уровень реализма и детализации изображения.   
    - Возможность интеграции с различными источниками данных (фото, каталоги одежды).   
    - Гибкость в обучении и адаптации под новые сценарии.   
2. **Негативные**:   
    - Требуется высокая вычислительная мощность для генерации в реальном времени.   
    - Возможны проблемы с генерацией в сложных условиях (например, при плохом освещении).   
    - Необходимость в качественной разметке данных для обучения.   
 --- 
